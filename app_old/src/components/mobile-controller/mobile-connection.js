import React, { useContext } from 'react'
import { BLEConnectionContext } from "../../util/ble-connection-provider";
import { MOBILE_SERVICE_ID } from "../../util/color-provider";
import { withBLE } from "../../util/withBLE"
import Button from '../button';

const Logo = props => <svg width="133" height="168" viewBox="0 0 133 168" fill="none" {...props}>
  <path fillRule="evenodd" clipRule="evenodd" d="M63.8959 93.7992V44.871C64.767 44.8563 65.6355 44.8497 66.5013 44.8497C67.3672 44.8497 68.2343 44.8563 69.1068 44.871V93.7979C73.6142 91.6794 78.9249 92.543 82.0743 95.0913C86.4952 98.6695 87.2188 105.807 82.8151 112.964C80.5448 116.868 75.3445 120.869 70.3304 123.818C67.9657 125.2 65.0383 125.201 62.6616 123.813C57.6568 120.869 52.4565 116.868 50.1876 112.964C45.7839 105.807 46.5075 98.6695 50.9284 95.0913C54.0778 92.543 59.3885 91.6781 63.8959 93.7992ZM82.8151 112.964L82.8417 112.923L82.7925 113.006L82.8151 112.964ZM50.1876 112.964L50.2102 113.006L50.161 112.923L50.1876 112.964ZM25.0413 71.2786C26.1132 71.904 26.9525 72.9113 27.3555 74.1502L29.4861 80.7132H36.3822C38.6232 80.7132 40.6089 82.1556 41.3018 84.2887C41.9934 86.4205 41.2353 88.7559 39.4225 90.0746L33.8432 94.1306L35.9765 100.696C36.6655 102.827 35.9074 105.159 34.0946 106.479C32.2804 107.797 29.8306 107.797 28.0151 106.478L22.4358 102.422L16.8578 106.477C15.0463 107.795 12.5911 107.798 10.7743 106.477C8.96288 105.159 8.20479 102.824 8.89772 100.692L11.0284 94.1306L5.4477 90.0733C3.63624 88.7559 2.87681 86.4205 3.56974 84.2887C4.26267 82.1556 6.24836 80.7132 8.48941 80.7132H15.3855L17.5161 74.1502C17.9191 72.91 18.7583 71.904 19.8303 71.2786V49.9968C21.4303 49.6814 23.1753 49.3501 25.0413 49.0134V71.2786ZM107.886 71.2786V49.0014C109.749 49.3354 111.493 49.6668 113.097 49.9822V71.2786C114.169 71.904 115.008 72.9113 115.411 74.1502L117.541 80.7132H124.437C126.679 80.7132 128.664 82.1556 129.357 84.2887C130.049 86.4205 129.291 88.7559 127.478 90.0746L121.898 94.1306L124.032 100.696C124.721 102.827 123.963 105.159 122.15 106.479C120.336 107.797 117.886 107.797 116.07 106.478L110.491 102.422L104.913 106.477C103.102 107.795 100.646 107.798 98.8297 106.477C97.0182 105.159 96.2601 102.824 96.953 100.692L99.0837 94.1306L93.503 90.0733C91.6915 88.7559 90.9321 86.4205 91.625 84.2887C92.318 82.1556 94.3037 80.7132 96.5447 80.7132H103.441L105.571 74.1502C105.974 72.91 106.814 71.904 107.886 71.2786ZM56.67 24.868V14.76C56.67 11.8804 59.0015 9.54639 61.8796 9.54639H71.1231C74.0012 9.54639 76.3327 11.8804 76.3327 14.76V24.868C98.3854 26.0217 119.344 30.594 125.718 32.0897C125.737 32.0936 125.754 32.0976 125.773 32.103C129.142 32.9307 131.537 35.9074 131.643 39.3592C131.646 39.4417 131.641 39.9248 131.634 40.0592C131.509 42.2601 130.449 44.3121 128.712 45.6827C126.858 47.1491 124.436 47.6814 122.194 47.1465C113.799 45.2382 89.4758 40.1922 66.5013 40.1922C43.5269 40.1922 19.2052 45.2382 10.8635 47.1358C8.57054 47.6827 6.1526 47.1518 4.28794 45.6853C2.46318 44.2429 1.38854 42.0552 1.35529 39.7332C1.35529 39.6972 1.3646 39.29 1.36593 39.2461C1.52021 35.8435 3.89692 32.9227 7.28443 32.091C13.6578 30.5953 34.6173 26.0217 56.67 24.868Z" fill="currentColor" />
</svg>

const Hand = props => <svg width="65" height="97" viewBox="0 0 65 97" fill="none" {...props}>
  <path d="M25.9982 0.0209351C24.3414 0.0209351 22.9982 1.36414 22.9982 3.02094V15.0209C22.9982 16.6777 24.3414 18.0209 25.9982 18.0209C27.6551 18.0209 28.9982 16.6777 28.9982 15.0209V3.02094C28.9982 1.36414 27.6551 0.0209351 25.9982 0.0209351ZM2.74818 13.0209C1.78958 13.0589 0.913976 13.5498 0.404376 14.5209C-0.423924 15.9558 0.0632759 17.7862 1.49818 18.6147L11.9044 24.6147C13.3392 25.443 15.1698 24.9558 15.9982 23.5209C16.8266 22.0861 16.3392 20.2559 14.9044 19.4272L4.49818 13.4272C3.93328 13.1465 3.32338 12.9979 2.74818 13.0209ZM49.1544 13.0209C48.6288 13.0109 48.0738 13.155 47.4982 13.4272L37.092 19.4272C35.6572 20.2559 35.1698 22.0861 35.9982 23.5209C36.8266 24.9558 38.6572 25.443 40.092 24.6147L50.4982 18.6147C51.9331 17.7862 52.4202 15.9558 51.592 14.5209C50.8357 13.4713 50.0309 13.0324 49.1544 13.0209ZM25.9982 20.0209C21.0642 20.0209 16.9982 24.0869 16.9982 29.0209V51.3335C15.5119 49.3453 13.8949 47.8249 11.9982 47.3021C9.39788 46.5856 7.06818 47.5176 5.49818 48.4272C3.60168 49.9337 1.94508 51.1056 1.27938 53.521C0.654176 55.7995 1.11578 58.2495 2.21698 61.0835C7.48848 73.7139 13.8746 85.9588 21.7482 94.9899C22.3062 95.6315 23.1478 96.0171 23.9982 96.021H50.9982C51.6348 96.021 52.269 95.8074 52.7794 95.4272C55.9113 93.1072 58.2506 89.3465 60.217 84.9272C62.1834 80.508 63.6655 75.3891 64.4357 70.396C65.2059 65.4029 65.2635 60.4651 64.1232 56.396C62.9636 52.2582 59.9046 48.5551 55.342 48.021C54.5694 47.999 53.7368 48.1251 53.0607 48.2085C52.4727 47.0782 51.6822 46.1706 50.8107 45.5521C49.0983 44.337 47.4073 43.9966 45.9357 44.0209C44.8798 44.0389 43.9206 44.3974 42.9982 44.8959C42.6289 44.4552 42.3314 43.8934 41.9044 43.5834C40.197 42.3434 38.4425 42.0209 36.9982 42.0209C36.3145 42.0209 35.6558 42.1246 34.9982 42.2709V29.0209C34.9982 24.0869 30.9322 20.0209 25.9982 20.0209ZM25.9982 26.0209C27.712 26.0209 28.9982 27.307 28.9982 29.0209V48.021C28.9982 49.3754 30.0204 50.6624 31.342 50.9585C32.6636 51.2546 34.1439 50.5295 34.717 49.3022C35.8082 47.8865 36.9427 47.9186 38.3732 48.4272C38.7311 48.6872 38.9982 48.8365 38.9982 50.021C38.9982 51.363 40.0047 52.6499 41.3107 52.9585C42.6168 53.2671 44.0889 52.5667 44.6857 51.3648C45.4658 49.7454 45.9742 49.943 47.342 50.4585C47.7522 50.7496 47.9982 50.8936 47.9982 52.021C48.0082 53.1748 48.7526 54.2797 49.8107 54.7398C50.8688 55.1998 52.1803 54.9896 53.0294 54.2085C53.0624 54.2745 54.365 53.853 54.842 54.021C56.7009 54.3024 57.6102 55.363 58.3732 58.0522C59.1637 60.8387 59.2137 65.0538 58.5294 69.4898C57.8452 73.9257 56.4411 78.6151 54.717 82.4899C53.1521 86.0065 51.2686 88.6329 49.717 90.021H25.4982C19.9051 82.4466 7.00058 62.0723 7.06068 55.146C7.87158 53.8128 9.13468 52.9479 10.4044 53.0835C11.9956 53.8865 12.3908 54.7109 13.342 56.4272L17.3107 64.3648C17.9076 65.5667 19.3796 66.2671 20.6857 65.9585C21.9917 65.6499 23.0024 64.363 22.9982 63.021V29.0209C22.9982 27.307 24.2843 26.0209 25.9982 26.0209Z" fill="currentColor" />
</svg>


function MobileConnection({ children }) {
  const { connection, connect, error } = useContext(BLEConnectionContext);

  if (!connection) return (
    <div className="min-h-screen w-full flex flex-col justify-evenly items-center">
      <header>
        <Logo className="text-baby-blue" />
      </header>
      <main className="flex flex-col items-center">
        <p className={'font-bold text-center mb-3 ' + (error ? `text-red-300` : `text-baby-blue`)}>{error || `Establish a connection to get started`}</p>
        <Button className="text-center" onClick={() => connect({
          filters: [{ services: [MOBILE_SERVICE_ID] }]
        })}>connect</Button>
        <Hand width={48} className="text-baby-blue mt-2" />
      </main>
    </div>
  )

  return <>{children}</>
}

export default withBLE(MobileConnection)